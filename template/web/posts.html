<link rel="stylesheet" href="/markdown/css/editormd.min.css"/>
<div class="row">
    <div class="col-sm-9">
        <ul class="list-group list-group-flush">
            <li class="list-group-item"><a href="">V2EX</a> › <a href="">游戏</a></li>
            <li class="list-group-item">
                <h5>{{ .posts.title }}</h5>
                <div>
                    <a href="" class="badge badge-light"><i class="fa fa-tag"></i> {{ .posts.node_name }} </a>
                    <a href="" class="badge badge-light"><i class="fa fa-user"></i> {{.posts.user_name}}</a>
                    <span class="badge badge-light"><i class="fa fa-eye"></i> {{.posts.view_num}} </span>
                    <span class="badge badge-light"><i class="fa fa-clock"></i> {{.posts.created_at}}</span>
                </div>
            </li>
            <li class="list-group-item posts-content">
                {{ .posts.content }}
            </li>
            <li class="list-group-item mt-2" style="color: #999;font-size: 14px;">
                {{ .posts.comment_num }} 条回复
            </li>
            {{range $comment := .comments}}
                <div class="list-group-item">
                    <div class="comment-user-info" style="height: 22px;">
                        <a href="/users/{{$comment.uid}}">
                            <img src="/{{$comment.avatar}}" style="border-radius: 10px;height: 30px;width:30px;">
                        </a>
                        <a href="" style="font-size: 14px;color:#999;"><strong>{{$comment.name}}</strong></a>
                        <span style="font-size: 14px;color: #999;">{{StrTime $comment.created_at.String}}</span>
                    </div>
                    <hr>
                    <div class="comment-content" style="font-size: 13px;">
                        {{if gt $comment.ruid 0}}
                            @ <a href="" style="color: #778087;">{{ $comment.r_user_name }}</a>
                        {{end}}
                        <p>{{ $comment.content }}</p>
                        <p style="width: 100%;text-align: right;">
                            <span style="font-size: 13px;color: #999;cursor: pointer;">回复</span>
                            <span style="font-size: 13px;color: #999;cursor: pointer;">举报</span>
                            <span style="font-size: 13px;color: #999;cursor: pointer;">删除</span>
                        </p>
                    </div>
                </div>
            {{end}}
            <li class="list-group-item">
                <div class="page">
                    {{ .page }}
                </div>
            </li>
            <li class="list-group-item mt-2">
                <form action="/comment" method="POST">
                    <div class="form-group">
                        <textarea class="form-control" rows="3" name="content"></textarea>
                    </div>
                    <input type="hidden" name="pid" value="{{ .posts.id }}">
                    <input type="hidden" name="ruid" value="0">
                    <input type="hidden" name="uid" value="{{ .Session.user.id }}">
                    <div class="form-group">
                        <button class="btn btn-dark btn-sm submit-btn">回复</button>
                    </div>
                </form>
            </li>
        </ul>
    </div>
</div>
<script>
    $(function () {
        editormd("editormd", {
            path: "/markdown/lib/",
            width: "100%",
            height: 300,
            codeFold: true,
            watch: false,
            lineNumbers: true,
            lineWrapping: false,
            // toolbarIcons: function () {
            //     return []
            // },
            placeholder: null,
            imageUpload: true,
            imageFormats: ["jpg", "jpeg", "gif", "png"],
            imageUploadURL: "/markdown/file",
            saveHTMLToTextarea: true,
        });
        $('.submit-btn').on('click', function () {
            console.log($('.editormd-preview-container').html());
        })
        $('[data-toggle="tooltip"]').tooltip()
    })
</script>